package com.Orangehrm;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.interactions.Actions;


public class OrangeHrm_Add_Employee {

	public static void main(String[] args) throws InterruptedException, IOException {
		
	               	WebDriver driver;
	            	String  ApplicationURLAddress="http://127.0.0.1/orangehrm-4.2.0.1/symfony/web/index.php/dashboard";		
	                System.setProperty("webdriver.chrome.driver", "./browserdriverfiles/chromedriver.exe");
                    driver=new ChromeDriver();
	                driver.get(ApplicationURLAddress);
	                driver.manage().window().maximize();
	                
	                FileInputStream logInTestDataFile =new FileInputStream("./src/com/Excelfiles/AddEmployeeTestSheet.xlsx");
			         XSSFWorkbook WorkBook =new XSSFWorkbook(logInTestDataFile);
			         XSSFSheet AddEmployeeData =WorkBook.getSheet("Sheet1");
	                
	                int rowCount=AddEmployeeData.getLastRowNum();//FINDING CELL COUNT
			 		for(int rowIndex=1;rowIndex<=rowCount;rowIndex++){
			 			Row testDataSheetRow=AddEmployeeData.getRow(rowIndex);
			 			Cell userNameTestDataCell=testDataSheetRow.getCell(4);
			 			String userNameTestData=userNameTestDataCell.getStringCellValue();
			 		    Cell rowOfCell=testDataSheetRow.getCell(5);
			 		    String passwordTestData=rowOfCell.getStringCellValue();

			 		    By userNamePoperty=By.id("txtUsername"); 
			 			WebElement userName=driver.findElement(userNamePoperty); 
			 			userName.sendKeys(userNameTestData);
			 			
			 			By passwordProperty=By.name("txtPassword");
			 			WebElement password=driver.findElement(passwordProperty);
			 			password.sendKeys(passwordTestData);

			 			By logInButtonProperty=By.className("button");
			 			WebElement logInButton=driver.findElement(logInButtonProperty);
			 			logInButton.click();
			       
			         
			
			        // id="menu_pim_viewPimModule"
			         By  pimProperty=By.id("menu_pim_viewPimModule");
			         WebElement pim=driver.findElement(pimProperty);
			      
			         Actions mouseHoverOperation=new Actions(driver);
			         mouseHoverOperation.moveToElement(pim).build().perform();   
			      
			         
			         FileInputStream logInTestDataFile =new FileInputStream("./src/com/Excelfiles/AddEmployeeTestSheet.xlsx");
			         XSSFWorkbook WorkBook =new XSSFWorkbook(logInTestDataFile);
			         XSSFSheet AddEmployeeData =WorkBook.getSheet("Sheet1");
			       

			        int rowCount=AddEmployeeData.getLastRowNum();//FINDING CELL COUNT
			 		for(int rowIndex=1;rowIndex<=rowCount;rowIndex++){
			 	    Row testDataSheetRow=AddEmployeeData.getRow(rowIndex);
			 		Cell FirstNameTestDataCell=testDataSheetRow.getCell(14);
			 		String FirstNameTestData=FirstNameTestDataCell.getStringCellValue();
			 	    Cell rowOfCell=testDataSheetRow.getCell(15);
			 	    String MiddleNameTestData=rowOfCell.getStringCellValue();
			 	     Cell rowOfCells=testDataSheetRow.getCell(16);
			 	    String LastNameTestData=rowOfCells.getStringCellValue();
			 	
			         
			         //<a href="/orangehrm-4.2.0.1/symfony/web/index.php/pim/addEmployee" id="menu_pim_addEmployee">Add Employee</a>
			         By  AddEmployeeProperty= By.linkText("Add Employee");
			         WebElement AddEmployee=driver.findElement(AddEmployeeProperty);
			         AddEmployee.click();
			    
			        // name="lastName"
			        //String expected_firstNameTestData =(FirstNameTestDataCell);
		            By firstNameProperty1=By.name("firstName");
		            WebElement firstName=driver.findElement(firstNameProperty1);
		            firstName.sendKeys(FirstNameTestData);
		        
		            //id="middleName"
		         //  String expected_middleNameTestData ="Patel";
		           By middleNameProperty=By.id("middleName");
		           WebElement middleName=driver.findElement(middleNameProperty);
		           middleName.sendKeys(MiddleNameTestData);
		        
		          //<input class="formInputText" maxlength="30" type="text" name="lastName" id="lastName">
		        //  String expected_lastNameTestData ="Emmadishetty";
		          By lastNameProperty=By.name("lastName");
		          WebElement lastName=driver.findElement(lastNameProperty);
		          lastName.sendKeys(LastNameTestData);
			      
		         // <input class="formInputText valid" maxlength="10" type="text" name="employeeId" value="0002" id="employeeId"> 

		         By employeeIdProperty = By.name("employeeId");
		         WebElement employeeId = driver.findElement(employeeIdProperty);
		         String Expected_employeeId = employeeId.getAttribute("value");
		         System.out.println("The text of the Expected webelement employee id is: " + Expected_employeeId);
		         System.out.println();
			     //	<input type="button" class="" id="btnSave" value="Save">
				
				 By saveButtonProperty=By.id("btnSave");
		         WebElement saveButton=driver.findElement(saveButtonProperty);
		         saveButton.click();
				
		       
				By firstNameProperty2 = By.id("personal_txtEmpFirstName");
				WebElement firstNameElement = driver.findElement(firstNameProperty2);
				String Actual_firstNameValue = firstNameElement.getAttribute("value");
				System.out.println("The Actual value of the first name is: " + Actual_firstNameValue);
				
				if(Actual_firstNameValue.equals(expected_firstNameTestData)){
				System.out.println("The Employee First Name Is Matched :-Pass");}
				else{
				System.out.println("The Employee First Name Is Not Matched :-Fail");}
				System.out.println();
				
				//name="personal[txtEmpMiddleName]" 
				By Middlenameproperty=By.name("personal[txtEmpMiddleName]");
		    	WebElement MiddlenameElement=driver.findElement(Middlenameproperty);
		    	String Actual_MiddleNameValue = MiddlenameElement.getAttribute("value");
				System.out.println("The Actual value of the Middle name is: " + Actual_MiddleNameValue);
				if(Actual_MiddleNameValue.equals(expected_middleNameTestData)){
				System.out.println("The Employee Middle Name Is Matched :-Pass");}
				else{
				System.out.println("The Employee Middle Name Is Not Matched :-Fail");}
				System.out.println();
				
				//name="personal[txtEmpLastName]"
				By Lastnameproperty=By.name("personal[txtEmpLastName]");
		    	WebElement LastnameElement=driver.findElement(Lastnameproperty);
		    	String Actual_LastNameValue = LastnameElement.getAttribute("value");
				System.out.println("The Actual value of the Last name is: " + Actual_LastNameValue);
				if(Actual_LastNameValue.equals(expected_lastNameTestData)){
				System.out.println("The Employee Last Name Is Matched :-Pass");}
				else{
				System.out.println("The Employee Last Name Is Not Matched :-Fail");}
			    System.out.println();

		    	//name="personal[txtEmployeeId]" 
			    By employeeIdProperty2 = By.name("personal[txtEmployeeId]");
		        WebElement employeeId2 = driver.findElement(employeeIdProperty2);
		        String Actual_employeeId = employeeId2.getAttribute("value");
		        System.out.println("The text of the Actual webelement employee id is: " + Actual_employeeId);
				
				if(Actual_employeeId.equals(Expected_employeeId)){
			    System.out.println("The Employee Id Is Matched :-Pass");}
				else{
				System.out.println("The Employee Id Is Not Matched :-Fail");}
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
				
					
				/*By welComeAdminProperty=By.partialLinkText("Admin");
				WebElement welComeAdmin=driver.findElement(welComeAdminProperty);	
			    welComeAdminProperty=By.partialLinkText("Admin");
   			    welComeAdmin=driver.findElement(welComeAdminProperty);
			    welComeAdmin.click();

				Thread.sleep(2000);

				By logOutProperty=By.linkText("Logout");
				WebElement logOut=driver.findElement(logOutProperty);
				logOut.click();
				
				driver.quit();*/
				
				
		
	}}


